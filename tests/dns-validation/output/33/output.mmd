---
config:
  flowchart:
    htmlLabels: true
    curve: basis
    padding: 25
    diagramPadding: 8
    wrappingWidth: 200
    rankSpacing: 50
    nodeSpacing: 50
    useMaxWidth: false
---
flowchart LR
    classDef internal fill:#b3d9ff,stroke:#0066cc,stroke-width:2px,color:black;
    classDef external fill:#b3ffb3,stroke:#006600,stroke-width:1px,color:black;
    classDef both fill:#d9b3ff,stroke:#8800cc,stroke-width:2px,color:black;
    classDef target fill:#f9f9f9,stroke:#999,stroke-dasharray: 5 5;
    classDef legendBox fill:#fafafa,stroke:#333,stroke-width:1px,color:black;
    classDef critical fill:#ffe0e0,stroke:#ff0000,stroke-width:5px,color:black,stroke-dasharray: 10 5;
    classDef internalWarning fill:#b3d9ff,stroke:#ff8800,stroke-width:4px,color:black;
    classDef externalWarning fill:#b3ffb3,stroke:#ff8800,stroke-width:4px,color:black;
    classDef bothWarning fill:#d9b3ff,stroke:#ff8800,stroke-width:4px,color:black;
    classDef internalInfo fill:#b3d9ff,stroke:#ccaa00,stroke-width:3px,color:black,stroke-dasharray: 5 5;
    classDef externalInfo fill:#b3ffb3,stroke:#ccaa00,stroke-width:3px,color:black,stroke-dasharray: 5 5;
    classDef bothInfo fill:#d9b3ff,stroke:#ccaa00,stroke-width:3px,color:black,stroke-dasharray: 5 5;
    classDef ipNode fill:#e8e8e8,stroke:#666,stroke-width:2px,color:black;
    classDef ipPrivate fill:#b3d9ff,stroke:#0066cc,stroke-width:2px,color:black;
    classDef ipPublic fill:#b3ffb3,stroke:#006600,stroke-width:2px,color:black;
    classDef sslValid fill:#d4edda,stroke:#28a745,stroke-width:2px,color:black;
    classDef sslWarning fill:#fff3cd,stroke:#ffc107,stroke-width:3px,color:black;
    classDef sslCritical fill:#f8d7da,stroke:#dc3545,stroke-width:4px,color:black;
    classDef sslError fill:#e2e3e5,stroke:#6c757d,stroke-width:2px,color:black,stroke-dasharray: 5 5;
    classDef leakedExternal fill:#ffebee,stroke:#e91e63,stroke-width:4px,color:black;
    classDef httpStatusOk fill:#c8e6c9,stroke:#2e7d32,stroke-width:1px,color:#000,font-size:9px;
    classDef httpStatusRedirect fill:#fff9c4,stroke:#f57c00,stroke-width:1px,color:#000,font-size:9px;
    classDef httpStatusError fill:#ffccbc,stroke:#d84315,stroke-width:1px,color:#000,font-size:9px;
    classDef httpStatusKo fill:#ffebee,stroke:#c62828,stroke-width:1px,color:#000,font-size:9px;
    classDef emailDerived fill:#fff9e6,stroke:#ff9800,stroke-width:1px,color:black,stroke-dasharray: 3 3;

    subgraph sg_loop1_example_com ["‚ö†Ô∏è&nbsp;**loop1&period;example&period;com**"]
        direction TB
        node_loop1_example_com_CNAME_loop2_3600_5["<b>CNAME</b>&nbsp;üö®&nbsp;1√óCRITICAL&nbsp;+&nbsp;1√óWARN&nbsp;|&nbsp;loop2.example.com&nbsp;|&nbsp;TTL:3600"]:::critical
    end
    style sg_loop1_example_com fill:#fff5f5,stroke:#ff0000,stroke-width:3px,color:#000
    subgraph sg_loop2_example_com ["‚ö†Ô∏è&nbsp;**loop2&period;example&period;com**"]
        direction TB
        node_loop2_example_com_CNAME_loop3_3600_6["<b>CNAME</b>&nbsp;üö®&nbsp;1√óCRITICAL&nbsp;+&nbsp;1√óWARN&nbsp;|&nbsp;loop3.example.com&nbsp;|&nbsp;TTL:3600"]:::critical
    end
    style sg_loop2_example_com fill:#fff5f5,stroke:#ff0000,stroke-width:3px,color:#000
    subgraph sg_loop3_example_com ["‚ö†Ô∏è&nbsp;**loop3&period;example&period;com**"]
        direction TB
        node_loop3_example_com_CNAME_loop4_3600_7["<b>CNAME</b>&nbsp;üö®&nbsp;1√óCRITICAL&nbsp;+&nbsp;1√óWARN&nbsp;|&nbsp;loop4.example.com&nbsp;|&nbsp;TTL:3600"]:::critical
    end
    style sg_loop3_example_com fill:#fff5f5,stroke:#ff0000,stroke-width:3px,color:#000
    subgraph sg_loop4_example_com ["‚ö†Ô∏è&nbsp;**loop4&period;example&period;com**"]
        direction TB
        node_loop4_example_com_CNAME_loop1_3600_8["<b>CNAME</b>&nbsp;üö®&nbsp;1√óCRITICAL&nbsp;+&nbsp;1√óWARN&nbsp;|&nbsp;loop1.example.com&nbsp;|&nbsp;TTL:3600"]:::critical
    end
    style sg_loop4_example_com fill:#fff5f5,stroke:#ff0000,stroke-width:3px,color:#000

    %% --- Relations CNAME/MX/NS ---
    node_loop1_example_com_CNAME_loop2_3600_5 -->|CNAME| sg_loop2_example_com
    node_loop2_example_com_CNAME_loop3_3600_6 -->|CNAME| sg_loop3_example_com
    node_loop3_example_com_CNAME_loop4_3600_7 -->|CNAME| sg_loop4_example_com
    node_loop4_example_com_CNAME_loop1_3600_8 -->|CNAME| sg_loop1_example_com

    %% --- N≈ìuds IP ---
