---
config:
  flowchart:
    htmlLabels: true
    curve: basis
    padding: 25
    diagramPadding: 8
    wrappingWidth: 200
---
flowchart LR
    classDef internal fill:#b3d9ff,stroke:#0066cc,stroke-width:2px,color:black;
    classDef external fill:#b3ffb3,stroke:#006600,stroke-width:1px,color:black;
    classDef both fill:#d9b3ff,stroke:#8800cc,stroke-width:2px,color:black;
    classDef target fill:#f9f9f9,stroke:#999,stroke-dasharray: 5 5;
    classDef legendBox fill:#fafafa,stroke:#333,stroke-width:1px,color:black;
    classDef critical fill:#ffe0e0,stroke:#ff0000,stroke-width:5px,color:black,stroke-dasharray: 10 5;
    classDef internalWarning fill:#b3d9ff,stroke:#ff8800,stroke-width:4px,color:black;
    classDef externalWarning fill:#b3ffb3,stroke:#ff8800,stroke-width:4px,color:black;
    classDef bothWarning fill:#d9b3ff,stroke:#ff8800,stroke-width:4px,color:black;
    classDef internalInfo fill:#b3d9ff,stroke:#ccaa00,stroke-width:3px,color:black,stroke-dasharray: 5 5;
    classDef externalInfo fill:#b3ffb3,stroke:#ccaa00,stroke-width:3px,color:black,stroke-dasharray: 5 5;
    classDef bothInfo fill:#d9b3ff,stroke:#ccaa00,stroke-width:3px,color:black,stroke-dasharray: 5 5;
    classDef ipNode fill:#e8e8e8,stroke:#666,stroke-width:2px,color:black;
    classDef ipPrivate fill:#ffe6e6,stroke:#cc0000,stroke-width:2px,color:black;
    classDef ipPublic fill:#e6f7ff,stroke:#0066cc,stroke-width:2px,color:black;
    classDef sslValid fill:#d4edda,stroke:#28a745,stroke-width:2px,color:black;
    classDef sslWarning fill:#fff3cd,stroke:#ffc107,stroke-width:3px,color:black;
    classDef sslCritical fill:#f8d7da,stroke:#dc3545,stroke-width:4px,color:black;
    classDef sslError fill:#e2e3e5,stroke:#6c757d,stroke-width:2px,color:black,stroke-dasharray: 5 5;
    classDef leakedExternal fill:#ffebee,stroke:#e91e63,stroke-width:4px,color:black;

    subgraph sg_example_com ["‚ö†Ô∏è&nbsp;**example&period;com**"]
        direction TB
        node_example_com_A_203_0_3600_1["<b>A</b>&nbsp;üü¢&nbsp;‚ÑπÔ∏è&nbsp;1√óINFO&nbsp;|&nbsp;203.0.113.10&nbsp;|&nbsp;TTL:3600"]:::externalInfo
        node_example_com_MX_mail__3600_2["<b>MX</b>&nbsp;üü¢&nbsp;|&nbsp;mail.example.com&nbsp;|&nbsp;TTL:3600"]:::external
        node_example_com_A_203_0_3600_1 ~~~ node_example_com_MX_mail__3600_2
        node_example_com_TXT_v_spf_3600_3["<b>TXT</b>&nbsp;üü¢&nbsp;|&nbsp;v=spf1&nbsp;mx&nbsp;ip4:203.0.113.10&nbsp;-all&nbsp;|&nbsp;TTL:3600"]:::external
        node_example_com_MX_mail__3600_2 ~~~ node_example_com_TXT_v_spf_3600_3
    end
    style sg_example_com fill:#fffffa,stroke:#ccaa00,stroke-width:1px,color:#000
    subgraph sg_mail_example_com ["**mail&period;example&period;com**"]
        direction TB
        node_mail_example_com_A_203_0_3600_4["<b>A</b>&nbsp;üü¢&nbsp;|&nbsp;203.0.113.20&nbsp;|&nbsp;TTL:3600"]:::external
        node_mail_example_com_AAAA_2001__3600_5["<b>AAAA</b>&nbsp;üü¢&nbsp;|&nbsp;2001:db8::20&nbsp;|&nbsp;TTL:3600"]:::external
        node_mail_example_com_A_203_0_3600_4 ~~~ node_mail_example_com_AAAA_2001__3600_5
    end
    style sg_mail_example_com fill:#ffffff,stroke:#999,stroke-width:1px,color:#000
    subgraph sg_selector1__domainkey_example_com ["**selector1&period;&lowbar;domainkey&period;example&period;com**"]
        direction TB
        node_selector1__domainkey_example_com_TXT_v_DKI_3600_6["<b>TXT</b>&nbsp;üü¢&nbsp;|&nbsp;v=DKIM1;&nbsp;k=rsa;&nbsp;p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC3QEKyU1fSma0axspqYK5iAj+54lsAg4qRRCnpKK68hawSd8zpsDz77ntGCPaQ+u0LCjkSZ5WE6cMKgGLDzpvPe97JiYVN0dS1i6T2DmJvVUNCJvs5L/cXQmXABF2qKHsFrZkpzqLLnqqcOjA32PkWxLV7p71lHOBqBH0f5l2LwwIDAQAB&nbsp;|&nbsp;TTL:3600"]:::external
    end
    style sg_selector1__domainkey_example_com fill:#ffffff,stroke:#999,stroke-width:1px,color:#000
    subgraph sg__dmarc_example_com ["**&lowbar;dmarc&period;example&period;com**"]
        direction TB
        node__dmarc_example_com_TXT_v_DMA_3600_7["<b>TXT</b>&nbsp;üü¢&nbsp;|&nbsp;v=DMARC1;&nbsp;p=quarantine;&nbsp;rua=mailto:dmarc@example.com;&nbsp;ruf=mailto:forensics@example.com;&nbsp;pct=100&nbsp;|&nbsp;TTL:3600"]:::external
    end
    style sg__dmarc_example_com fill:#ffffff,stroke:#999,stroke-width:1px,color:#000
    subgraph sg_autodiscover_example_com ["**autodiscover&period;example&period;com**"]
        direction TB
        node_autodiscover_example_com_CNAME_autod_3600_8["<b>CNAME</b>&nbsp;üü¢&nbsp;|&nbsp;autodiscover.outlook.com&nbsp;|&nbsp;TTL:3600"]:::external
    end
    style sg_autodiscover_example_com fill:#ffffff,stroke:#999,stroke-width:1px,color:#000

    %% --- Relations CNAME/MX/NS ---
    node_example_com_MX_mail__3600_2 -->|MX| node_mail_example_com_A_203_0_3600_4
    node_example_com_MX_mail__3600_2 -->|MX| node_mail_example_com_AAAA_2001__3600_5

    %% --- N≈ìuds IP ---
    subgraph ip_cluster ["üåê Adresses IP"]
        direction LR
        node_IP_203_0_113_10[["üåê&nbsp;<b>IPv4</b>&nbsp;Publique&nbsp;|&nbsp;203.0.113.10&nbsp;|&nbsp;1√óutilis√©"]]:::ipPublic
        node_IP_203_0_113_20[["üåê&nbsp;<b>IPv4</b>&nbsp;Publique&nbsp;|&nbsp;203.0.113.20&nbsp;|&nbsp;1√óutilis√©"]]:::ipPublic
        node_IP_2001_db8__20[["üåê&nbsp;<b>IPv6</b>&nbsp;Publique&nbsp;|&nbsp;2001:db8::20&nbsp;|&nbsp;1√óutilis√©"]]:::ipPublic
    end    style ip_cluster fill:#f9f9f9,stroke:#999,stroke-width:1px,stroke-dasharray: 3 3
    node_example_com_A_203_0_3600_1 -->|resolves| node_IP_203_0_113_10
    node_mail_example_com_A_203_0_3600_4 -->|resolves| node_IP_203_0_113_20
    node_mail_example_com_AAAA_2001__3600_5 -->|resolves| node_IP_2001_db8__20
