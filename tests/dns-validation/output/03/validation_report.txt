â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           DNS RFC VALIDATION REPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Date: 2026-01-22T10:34:40.930Z
Source file: /home/runner/work/DNS2Mermaid/DNS2Mermaid/tests/dns-validation/03_critical_cname_loop.csv
Domains analyzed: 1
Violations detected: 2

ğŸš¨ BLOCKING VIOLATIONS (CRITICAL): 1
âš ï¸  ISSUES TO FIX (WARNING): 1
â„¹ï¸  BEST PRACTICES (INFO): 0

RULE SUMMARY:

   âš ï¸ CNAME_CHAIN: 1 violation(s)
   ğŸš¨ CNAME_LOOP: 1 violation(s)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸš¨ BLOCKING VIOLATIONS (TO FIX IMMEDIATELY):

1. [CNAME_LOOP] loop.example.com
   CNAME crÃ©e une boucle DNS : loop.example.com â†’ loop.example.com
   Reference: RFC 1034 Section 3.6.2
   Affected records: CNAME loop.example.com


âš ï¸  ISSUES TO FIX QUICKLY:

1. [CNAME_CHAIN] loop.example.com
   CNAME pointe vers un autre CNAME (loop.example.com -> loop.example.com)
   Reference: RFC 2181 Section 10.1 (Performance)
   Affected records: CNAME loop.example.com


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
RULES VALIDATED (19 rules, 3 levels):

ğŸš¨ BLOCKING (CRITICAL) - RFC Violations:
1. CNAME_COEXISTENCE: A CNAME cannot coexist with other record types (RFC 1034)
2. CNAME_ON_APEX: CNAME forbidden on zone apex/root domain (RFC 1912)
3. CNAME_LOOP: A CNAME cannot point to itself
4. MX_TO_CNAME: MX records cannot point to CNAMEs (RFC 2181)
5. NS_TO_CNAME: NS records cannot point to CNAMEs (RFC 2181)
6. MX_NO_GLUE / NS_NO_GLUE: MX/NS must point to names with A/AAAA records
7. SPF_TOO_PERMISSIVE: SPF with +all allows everyone

âš ï¸  IMPORTANT (WARNING) - To fix quickly:
8. CNAME_CHAIN: Chained CNAMEs degrade performance (RFC 2181)
9. INCONSISTENT_TTL: Inconsistent TTLs cause unpredictable behavior
10. TTL_TOO_SHORT: TTL < 60s generates excessive DNS load
11. SPF_NEUTRAL: SPF with ?all provides little protection
12. MX_ORPHAN / NS_ORPHAN: Points to an unresolved name
13. VIEW_SEGREGATION_PRIVATE_EXTERNAL: Private RFC 1918 IP exposed in external view

â„¹ï¸  RECOMMENDATIONS (INFO) - Best practices:
14. MISSING_IPV6: A record without AAAA (modernize)
15. TTL_TOO_LONG: TTL > 86400s makes changes slow
16. WILDCARD_RESTRICTION: Caution with wildcards and certain types
17. DUPLICATE_RECORD: Redundant identical records
18. CNAME_ORPHAN: CNAME points to a name absent from dataset (check if external)
19. INCONSISTENT_TTL_MULTIVIEW: Same record with different TTLs across views
